# SSH Backup Configuration (independent from main btrbk)
# Run manually: sudo btrbk -c /etc/btrbk/btrbk-ssh.conf run
# Or via timer: systemctl start btrbk-ssh.service

# Logging and locking (separate from main)
transaction_log            /var/log/btrbk-ssh.log
lockfile                   /run/lock/btrbk-ssh.lock

# Use sudo for btrfs commands
backend_local_user         btrfs-progs-sudo

# Performance settings optimized for 2.5G LAN
stream_buffer              1g
stream_buffer_remote       1g
stream_compress            no
ssh_compression            no

# Timestamp format
timestamp_format           long

# Don't create snapshots - use existing ones from main btrbk
snapshot_create            no

# Use incremental backups
incremental                yes

# SSH target retention: 7 days + 4 weekly + 3 monthly
target_preserve_min        latest
target_preserve            7d 4w 3m

# SSH configuration
ssh_identity     /etc/btrbk/ssh/id_rsa
ssh_user         root
backend_remote   btrfs-progs-sudo

# Volume configuration
volume /mnt/btr_pool
  snapshot_dir     btrbk_snapshots

  # SSH Target - Network backup to homelab
  target ssh://px-nas.lan/laptop_backups

  # Subvolumes to backup
  subvolume   @root
  subvolume   @home
